'use strict';const brd_toc={init(){this.set_observers();this.listeners();this.sticky_sidebar();this.open_img()},listeners(){const nav_items=document.body.querySelectorAll('.link_target');if(!nav_items.length)
return;if(nav_items[0].closest('[data-nav=native]'))
return;for(let i=0;i<nav_items.length;i++)
nav_items[i].addEventListener('click',this.scroll_to);},unset_active(){const actives=document.body.querySelectorAll('.link_target.active');if(!actives.length)
return;for(let i=0;i<actives.length;i++)
actives[i].classList.remove('active');},change_nav(entries,observer){for(let i=0;i<entries.length;i++){if(!entries[i].isIntersecting||!entries[i].intersectionRatio>observer.thresholds[0]){return}
brd_toc.unset_active();const id=entries[i].target.getAttribute('id');if(!id)
return;const current=document.querySelector(`[href="#${id}"]`);if(current)
current.classList.add('active')}},set_observers(){const sections=document.querySelectorAll('.toc_panel.has_title, '+'.howto_item');if(!sections.length)
return;for(let i=0;i<sections.length;i++){const ratio=sections[i].offsetHeight/window.innerHeight;let ratio_normalized=0;if(ratio>1)
ratio_normalized=1/ratio/2;else ratio_normalized=ratio;const opts={threshold:ratio_normalized};const observer=new IntersectionObserver(this.change_nav,opts);observer.observe(sections[i])}},scroll_to(e){e.preventDefault();const target=e.currentTarget;setTimeout(()=>{brd_toc.unset_active();target.classList.add('active')},50);const href=e.currentTarget.getAttribute('href');if(!href)
return;const hash=href.substring(1);const el=document.getElementById(hash);if(!el)
return;const header=document.body.querySelector('.page_header');let header_height=header?header.offsetHeight+140:100;const scroll_pos=el.getBoundingClientRect().top+window.pageYOffset-header_height;window.location.hash=hash;const scroll_behavior=window.matchMedia('(prefers-reduced-motion)').matches?'auto':'smooth';window.scrollTo({top:scroll_pos,behavior:scroll_behavior})},sticky_sidebar(){if(typeof StickySidebar==='undefined')
return;if(!document.querySelector('.sidebar'))
return;let offset=0;const header_offset=document.body.style.getPropertyValue('--html-offset')||0;const spacer=8;const tc_menu=document.getElementById('tc_menu');if(tc_menu)
offset=offset+tc_menu.offsetHeight;console.log('offset tc',offset);offset=offset+parseInt(header_offset)+spacer*2;console.log('offset',offset);const sidebar=new StickySidebar('.sidebar',{topSpacing:offset,bottomSpacing:spacer,containerSelector:'.howto .row, .toc .row',innerWrapperSelector:'.sidebar_inner',resizeSensor:!0,})},open_img(){document.querySelectorAll('.modal_trigger').forEach(item=>{item.addEventListener('click',function(e){e.preventDefault();const modal_image=document.getElementById('modal_image');const image_url=this.getAttribute('data-image');const image_alt=this.getAttribute('data-alt');if(!modal_image)
return;modal_image.setAttribute('src',image_url);modal_image.setAttribute('alt',image_alt);MicroModal.show('global_modal')})})},};brd_toc.init()